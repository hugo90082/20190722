<script src="utils.js"></script>
<h1 id="head"></h1>

<hr>
<canvas id="canvas" width="480" height="320" style="border: 1px solid black"></canvas>
<script>
    //head.innerHTML = 'CY'
    let ctx = canvas.getContext('2d');    // 渲染
    let bg = new Image();
        bg.src = 'bg.jpg';
        let ballImg = new Image();
        let bar = new Image();
        ballImg.src = 'ball1.png';
        bar.src = 'bar.png';

        let balls = [];
        let ballObj = {
            x: 100,
            y: 160,
            dx: 8,
            dy: 8,
            img: 0
        };

        let barX = 0;
        canvas.onmousemove = function (event) {
        barX = event.offsetX;
        ctx.drawImage(bar,barX, 300);
        ctx.stroke();

        console.log("Drag:"+event.offsetX+"X"+event.offsetY+"Y")
        }

        bg.onload = function () {
            ctx.drawImage(bg, 0, 0);
        }
        canvas.onmousedown = function (event) {

            ballObj.x = event.offsetX - 24;
            ballObj.y = event.offsetY - 24;
            ballObj.dx = 5
            ballObj.dy = 5
            balls.push(ballObj);
        }

        function refreshView() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.drawImage(bg, 0, 0);
            ctx.drawImage(ballImg, ballObj.x, ballObj.y);
            ctx.drawImage(bar,barX, 300);
        }
        setInterval(refreshView, 17);
        function moveBall(obj) {

            if (obj.x < 0 || obj.x + 48 > canvas.width) {
                obj.dx *= -1;
            }
            if (obj.y < 0 || obj.y + 48 > canvas.height) {
                obj.dy *= -1;
            }
            obj.x += obj.dx; 
            obj.y += obj.dy;
        }

        function go() {
            for (let ball of balls) {
                if(){
                    moveBall(ball);
                }
                
            }
        }
        setInterval(go, 100);

    // function moveBall(){
    //     if(ballX < 0 || ballX+48>canvas.width){
    //         dx *= -1
    //     }
    //     if (ballY < 0 || ballY + 48 > canvas.height) {
    //         dy *= -1
    //     }
    //     ballX += dx
    //     ballY += dy
    // }
    // setInterval(moveBall, 30);
</script>